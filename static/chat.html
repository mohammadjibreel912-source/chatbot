<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Jordanian University Chatbot</title>
<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f4f8;
    margin: 0;
    padding: 0;
}

.container {
    max-width: 700px;
    margin: 40px auto;
    background: #ffffff;
    border-radius: 15px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    height: 80vh;
    overflow: hidden;
}

header {
    text-align: center;
    padding: 20px;
    background: linear-gradient(90deg, #4a90e2, #007bff);
    color: white;
    font-size: 24px;
    font-weight: bold;
    border-radius: 15px 15px 0 0;
    box-shadow: inset 0 -2px 5px rgba(0,0,0,0.1);
}

#chat {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    background: #f9fafb;
}

.bubble {
    padding: 12px 20px;
    border-radius: 25px;
    margin: 5px 0;
    max-width: 75%;
    word-wrap: break-word;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.user {
    background: #d1f2c4;
    align-self: flex-end;
    text-align: right;
    color: #333;
}

.bot {
    background: #e6e6e6;
    align-self: flex-start;
    text-align: left;
    color: #333;
}

footer {
    display: flex;
    padding: 15px;
    border-top: 1px solid #ddd;
    background: #f5f5f5;
}

input[type=text] {
    flex: 1;
    padding: 12px 20px;
    border-radius: 25px;
    border: 1px solid #ccc;
    font-size: 16px;
    outline: none;
}

button {
    margin-left: 10px;
    padding: 12px 25px;
    border: none;
    border-radius: 25px;
    background: #007bff;
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.3s;
}

button:hover {
    background: #0056b3;
}

button.clear {
    background: #dc3545;
}

button.clear:hover {
    background: #a71d2a;
}
</style>
</head>
<body>
<div class="container">
    <header>Jordanian University Chatbot</header>
    <div id="chat"></div>
    <footer>
        <input type="text" id="question" placeholder="اكتب سؤالك هنا" onkeypress="if(event.key==='Enter'){askQuestion();}">
        <button onclick="askQuestion()">إرسال</button>
        <button class="clear" onclick="clearChat()">مسح المحادثة</button>
    </footer>
</div>

<script>
const API_URL = "/ask";

function addMessage(text, sender) {
    if(!text || text.trim() === "") return; // منع الرسائل الفارغة
    const chat = document.getElementById("chat");
    const bubble = document.createElement("div");
    bubble.className = "bubble " + sender;
    bubble.innerText = text;
    chat.appendChild(bubble);
    chat.scrollTop = chat.scrollHeight;
}

async function askQuestion() {
    const questionInput = document.getElementById("question");
    const question = questionInput.value;
    if(!question.trim()) return;
    addMessage(question, "user");
    questionInput.value = "";

    try {
        const formData = new FormData();
        formData.append("question", question);
        const res = await fetch(API_URL, { method:"POST", body:formData });
        const data = await res.json();

        // إذا لم يكن هناك إجابة واضحة
        if(!data.answer || data.answer.trim() === "" || data.answer.includes("لا توجد بيانات")) {
            addMessage("⚠ المعلومة غير موجودة", "bot");
        } else {
            addMessage(data.answer, "bot");
        }
    } catch (e) {
        addMessage("⚠ لا يمكن الاتصال بالـ API", "bot");
    }
}

function clearChat() {
    const chat = document.getElementById("chat");
    chat.innerHTML = "";
}
</script>
</body>
</html>
